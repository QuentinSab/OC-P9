{% extends "base.html" %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'reviews/post.css' %}">
    <link rel="stylesheet" href="{% static 'reviews/starability/starability-basic.css' %}">
{% endblock %}

{% block content %}
    <div class="content">

        <h2>Mes publications</h2>

        {% if posts %}

            <ul class="post-list">
                {% for post in posts %}

                    {% if post.content_type == "review" %}
                        <div class="review">

                            <h3>Critique de {{ post.user }}</h3>
                            <p><strong>{{ post.headline }}</strong></p>
                            <div class="starability-result" data-rating="{{ post.rating }}" aria-label="{{ post.rating }} étoiles sur 5"></div>
                            <p>{{ post.body }}</p>

                            {% if post.user == request.user %}
                                <div class="action">
                                    <a href="{% url 'edit_review' post.id %}">Modifier</a>
                                    <a href="{% url 'delete_review' post.id %}">Supprimer</a>
                                </div>
                                
                            {% endif %}

                            <div class="ticket">
                                <h4>Ticket lié : {{ post.ticket.title }}</h4>
                                <p>{{ post.ticket.description }}</p>
                                {% if post.ticket.image %}
                                    <img src="{{ post.ticket.image.url }}" alt="Image du ticket">
                                {% endif %}
                            </div>

                        </div>

                    {% elif post.content_type == "ticket" %}

                        <div class="ticket">

                            <h3>Ticket de {{ post.user }}</h3>
                            <p><strong>{{ post.title }}</strong></p>
                            <p>{{ post.description }}</p>

                            {% if post.image %}
                                <img src="{{ post.image.url }}" alt="Image du ticket">
                            {% endif %}

                            {% if post.user == request.user %}
                                <div class="action">
                                    <a href="{% url 'edit_ticket' post.id %}">Modifier</a>
                                    <a href="{% url 'delete_ticket' post.id %}">Supprimer</a>
                                </div>
                                
                            {% endif %}

                        </div>

                    {% endif %}

                {% endfor %}
            </ul>

        {% else %}

            <p>Aucune publication pour le moment.</p>

        {% endif %}

    </div>
{% endblock %}